{"ast":null,"code":"import _regeneratorRuntime from \"/home/mikit0321/webdev/react/mern-typescript-boilerplate/my-app/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/mikit0321/webdev/react/mern-typescript-boilerplate/my-app/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/home/mikit0321/webdev/react/mern-typescript-boilerplate/my-app/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/mikit0321/webdev/react/mern-typescript-boilerplate/my-app/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/mikit0321/webdev/react/mern-typescript-boilerplate/my-app/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/mikit0321/webdev/react/mern-typescript-boilerplate/my-app/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/mikit0321/webdev/react/mern-typescript-boilerplate/my-app/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/mikit0321/webdev/react/mern-typescript-boilerplate/my-app/frontend/src/App.tsx\";\nimport axios from \"axios\";\nimport React from \"react\";\nimport \"./App.css\";\nimport logo from \"./logo.svg\";\nimport { isSessionValid, setSession, clearSession, getAuthHeaders } from \"./session\";\n\nvar App =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(App, _React$Component);\n\n  function App() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, App);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(App)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      email: \"\",\n      password: \"\",\n      isRequesting: false,\n      isLoggedIn: false,\n      data: [],\n      error: \"\"\n    };\n    _this.handleLogin =\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      var _this$state, email, password, response, _response$data, token, expiry;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _this$state = _this.state, email = _this$state.email, password = _this$state.password;\n              _context.prev = 1;\n\n              _this.setState({\n                error: \"\"\n              });\n\n              _this.setState({\n                isRequesting: true\n              });\n\n              _context.next = 6;\n              return axios.post(\"/api/users/login\", {\n                email: email,\n                password: password\n              });\n\n            case 6:\n              response = _context.sent;\n              _response$data = response.data, token = _response$data.token, expiry = _response$data.expiry;\n              setSession(token, expiry);\n\n              _this.setState({\n                isLoggedIn: true\n              });\n\n              _context.next = 15;\n              break;\n\n            case 12:\n              _context.prev = 12;\n              _context.t0 = _context[\"catch\"](1);\n\n              _this.setState({\n                error: \"Something went wrong\"\n              });\n\n            case 15:\n              _context.prev = 15;\n\n              _this.setState({\n                isRequesting: false\n              });\n\n              return _context.finish(15);\n\n            case 18:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[1, 12, 15, 18]]);\n    }));\n\n    _this.logout = function () {\n      clearSession();\n\n      _this.setState({\n        isLoggedIn: false\n      });\n    };\n\n    _this.getTestData =\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee2() {\n      var response;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n\n              _this.setState({\n                error: \"\"\n              });\n\n              _context2.next = 4;\n              return axios.get(\"/api/items\", {\n                headers: getAuthHeaders()\n              });\n\n            case 4:\n              response = _context2.sent;\n\n              _this.setState({\n                data: response.data\n              });\n\n              _context2.next = 11;\n              break;\n\n            case 8:\n              _context2.prev = 8;\n              _context2.t0 = _context2[\"catch\"](0);\n\n              _this.setState({\n                error: \"Something went wrong\"\n              });\n\n            case 11:\n              _context2.prev = 11;\n\n              _this.setState({\n                isRequesting: false\n              });\n\n              return _context2.finish(11);\n\n            case 14:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[0, 8, 11, 14]]);\n    }));\n    return _this;\n  }\n\n  _createClass(App, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.setState({\n        isLoggedIn: isSessionValid()\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      return React.createElement(\"div\", {\n        className: \"App\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 32\n        },\n        __self: this\n      }, React.createElement(\"header\", {\n        className: \"App-header\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 33\n        },\n        __self: this\n      }, React.createElement(\"img\", {\n        src: logo,\n        className: \"App-logo\",\n        alt: \"logo\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 34\n        },\n        __self: this\n      }), React.createElement(\"h1\", {\n        className: \"App-title\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 35\n        },\n        __self: this\n      }, \"Welcome to React\")), React.createElement(\"div\", {\n        className: \"App-error\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 37\n        },\n        __self: this\n      }, this.state.error), this.state.isLoggedIn ? React.createElement(\"div\", {\n        className: \"App-private\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 39\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 40\n        },\n        __self: this\n      }, \"Server test data:\", React.createElement(\"ul\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 42\n        },\n        __self: this\n      }, this.state.data.map(function (item, index) {\n        return React.createElement(\"li\", {\n          key: index,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 44\n          },\n          __self: this\n        }, \"name: \", item.name, \" / value: \", item.value);\n      }))), React.createElement(\"button\", {\n        disabled: this.state.isRequesting,\n        onClick: this.getTestData,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 50\n        },\n        __self: this\n      }, \"Get test data\"), React.createElement(\"button\", {\n        disabled: this.state.isRequesting,\n        onClick: this.logout,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 53\n        },\n        __self: this\n      }, \"Log out\")) : React.createElement(\"div\", {\n        className: \"App-login\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 58\n        },\n        __self: this\n      }, \"(try the credentials: testuser@email.com / my-password)\", React.createElement(\"input\", {\n        disabled: this.state.isRequesting,\n        placeholder: \"email\",\n        type: \"text\",\n        onChange: function onChange(e) {\n          return _this2.setState({\n            email: e.target.value\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 60\n        },\n        __self: this\n      }), React.createElement(\"input\", {\n        disabled: this.state.isRequesting,\n        placeholder: \"password\",\n        type: \"password\",\n        onChange: function onChange(e) {\n          return _this2.setState({\n            password: e.target.value\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 66\n        },\n        __self: this\n      }), React.createElement(\"button\", {\n        disabled: this.state.isRequesting,\n        onClick: this.handleLogin,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 72\n        },\n        __self: this\n      }, \"Log in\")));\n    }\n  }]);\n\n  return App;\n}(React.Component);\n\nexport default App;","map":{"version":3,"sources":["/home/mikit0321/webdev/react/mern-typescript-boilerplate/my-app/frontend/src/App.tsx"],"names":["axios","React","isSessionValid","setSession","clearSession","getAuthHeaders","App","state","email","password","isRequesting","isLoggedIn","data","error","handleLogin","setState","post","response","token","expiry","logout","getTestData","get","headers","logo","map","item","index","name","value","e","target","Component"],"mappings":"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","sourcesContent":["import axios from \"axios\";\nimport React from \"react\";\nimport \"./App.css\";\nimport logo from \"./logo.svg\";\nimport { isSessionValid, setSession, clearSession, getAuthHeaders } from \"./session\";\n\nexport interface AppState {\n  email: string;\n  password: string;\n  isRequesting: boolean;\n  isLoggedIn: boolean;\n  data: App.Item[];\n  error: string;\n}\n\nclass App extends React.Component<{}, AppState> {\n  public state = {\n    email: \"\",\n    password: \"\",\n    isRequesting: false,\n    isLoggedIn: false,\n    data: [],\n    error: \"\",\n  };\n\n  public componentDidMount() {\n    this.setState({ isLoggedIn: isSessionValid() });\n  }\n\n  public render() {\n    return (\n      <div className=\"App\">\n        <header className=\"App-header\">\n          <img src={logo} className=\"App-logo\" alt=\"logo\" />\n          <h1 className=\"App-title\">Welcome to React</h1>\n        </header>\n        <div className=\"App-error\">{this.state.error}</div>\n        {this.state.isLoggedIn ? (\n          <div className=\"App-private\">\n            <div>\n              Server test data:\n              <ul>\n                {this.state.data.map((item: App.Item, index) => (\n                  <li key={index}>\n                    name: {item.name} / value: {item.value}\n                  </li>\n                ))}\n              </ul>\n            </div>\n            <button disabled={this.state.isRequesting} onClick={this.getTestData}>\n              Get test data\n            </button>\n            <button disabled={this.state.isRequesting} onClick={this.logout}>\n              Log out\n            </button>\n          </div>\n        ) : (\n          <div className=\"App-login\">\n            (try the credentials: testuser@email.com / my-password)\n            <input\n              disabled={this.state.isRequesting}\n              placeholder=\"email\"\n              type=\"text\"\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) => this.setState({ email: e.target.value })}\n            />\n            <input\n              disabled={this.state.isRequesting}\n              placeholder=\"password\"\n              type=\"password\"\n              onChange={(e: React.ChangeEvent<HTMLInputElement>) => this.setState({ password: e.target.value })}\n            />\n            <button disabled={this.state.isRequesting} onClick={this.handleLogin}>\n              Log in\n            </button>\n          </div>\n        )}\n      </div>\n    );\n  }\n\n  private handleLogin = async (): Promise<void> => {\n    const { email, password } = this.state;\n    try {\n      this.setState({ error: \"\" });\n      this.setState({ isRequesting: true });\n      const response = await axios.post<{ token: string; expiry: string }>(\"/api/users/login\", { email, password });\n      const { token, expiry } = response.data;\n      setSession(token, expiry);\n      this.setState({ isLoggedIn: true });\n    } catch (error) {\n      this.setState({ error: \"Something went wrong\" });\n    } finally {\n      this.setState({ isRequesting: false });\n    }\n  };\n\n  private logout = (): void => {\n    clearSession();\n    this.setState({ isLoggedIn: false });\n  };\n\n  private getTestData = async (): Promise<void> => {\n    try {\n      this.setState({ error: \"\" });\n      const response = await axios.get<App.Item[]>(\"/api/items\", { headers: getAuthHeaders() });\n      this.setState({ data: response.data });\n    } catch (error) {\n      this.setState({ error: \"Something went wrong\" });\n    } finally {\n      this.setState({ isRequesting: false });\n    }\n  };\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}